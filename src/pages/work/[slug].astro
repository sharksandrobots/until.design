---
import { getCollection } from 'astro:content';
import CaseStudy from './case-study.astro';
import ProjectSnapshot from './project-snapshot.astro';

export async function getStaticPaths() {
	const caseStudies = await getCollection('case-studies');
	const projectSnapshots = await getCollection('project-snapshots');
	
	// Redirect case-study and project-snapshot to /work
	const redirects = [
		{
			params: { slug: 'case-study' },
			redirect: '/work'
		},
		{
			params: { slug: 'project-snapshot' },
			redirect: '/work'
		}
	];
	
	const caseStudyPaths = caseStudies.map(caseStudy => ({
		params: { slug: caseStudy.slug },
		props: { caseStudy }
	}));

	const projectSnapshotPaths = projectSnapshots.map(snapshot => ({
		params: { slug: snapshot.slug },
		props: { snapshot }
	}));

	return [...redirects, ...caseStudyPaths, ...projectSnapshotPaths];
}

const { caseStudy, snapshot } = Astro.props;
---

{caseStudy && <CaseStudy caseStudy={caseStudy} />}
{snapshot && <ProjectSnapshot snapshot={snapshot} />}

